{% extends "base.html" %}
{% block title %}SKEIN - {{ site.site_id }}{% endblock %}

{% block content %}
<section>
    <p class="breadcrumb"><a href="/sites">Sites</a> / {{ site.site_id }}</p>
    <h1>{{ site.site_id }}</h1>
    {% if site.description %}
    <p class="subtitle">{{ site.description }}</p>
    {% endif %}
</section>

<section>
    <div class="filters">
        <label>Type:</label>
        <select hx-get="/sites/{{ site.site_id }}" hx-target="body" hx-push-url="true" name="type" onchange="this.form.submit()">
            <option value="">All</option>
            {% for t in available_types %}
            <option value="{{ t }}" {% if current_type == t %}selected{% endif %}>{{ t }}</option>
            {% endfor %}
        </select>
        <label>Status:</label>
        <select hx-get="/sites/{{ site.site_id }}" hx-target="body" hx-push-url="true" name="status" onchange="this.form.submit()">
            <option value="">All</option>
            {% for s in available_statuses %}
            <option value="{{ s }}" {% if current_status == s %}selected{% endif %}>{{ s }}</option>
            {% endfor %}
        </select>
    </div>

    {% if folios %}
    <ul class="item-list">
        {% for folio in folios %}
        <li>
            <a class="item-title" href="/folios/{{ folio.folio_id }}">{{ (folio.title or folio.folio_id) | clean_title(folio.folio_id) }}</a>
            <div class="item-meta">
                <span class="type-tag {{ folio.type }}">{{ folio.type }}</span>
                · {{ folio.status or 'open' }}
                · {{ folio.created_at.strftime('%b %d') if folio.created_at else '' }}
            </div>
        </li>
        {% endfor %}
    </ul>
    {% else %}
    <p>No folios{% if current_type or current_status %} matching filters{% endif %}.</p>
    {% endif %}
</section>
{% endblock %}
